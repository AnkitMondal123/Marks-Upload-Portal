{% extends "_base.html" %}
{% load static %}
{% block content %}
<h3 class="mb-4 text-center">Create CO</h3>
<form method="POST" class="container">
  {% csrf_token %}
  
  <!-- Align Batch, Semester, and Course in the same row -->
  <div class="row mb-3">
    <div class="col-md-4">
      <label for="batch_selector" class="form-label">Select Batch:</label>
      <select id="batch_selector" name="batch_selector" class="form-select">
        <option value="">-- Select Batch --</option>
        {% for b in batches %}
          <option value="{{ b.id }}">{{ b.name }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="col-md-4">
      <label for="semester_selector" class="form-label">Select Semester:</label>
      <select id="semester_selector" name="semester_selector" class="form-select">
        <option value="">-- Select Semester --</option>
        {% for s in semesters %}
          <option value="{{ s.id }}">{{ s.semester_name }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="col-md-4">
      <label for="course_selector" class="form-label">Select Course:</label>
      <select id="course_selector" name="course_selector" class="form-select">
        <option value="">-- Select Course --</option>
        {% for c in courses %}
          <option value="{{ c.id }}">{{ c.course_title }}</option>
        {% endfor %}
      </select>
    </div>
  </div>
  
  <hr>
  
  <!-- Table for CO Details -->
  <table id="coTable" class="table table-bordered text-center">
    <thead class="table-light">
      <tr>
        <th>CO Text</th>
        <th>Details</th>
        <th>Action Verb</th>
        <th>Knowledge Level</th>
      </tr>
    </thead>
    <tbody>
      <!-- Rows will be added by JS -->
    </tbody>
  </table>
  
  <input type="hidden" name="total_rows" id="total_rows" value="0" />
  <div class="mb-3">
    <button type="button" class="btn btn-secondary" onclick="addRow()">Add Row</button>
  </div>
  
  <div class="text-center">
    <button type="submit" class="btn btn-primary">Submit</button>
  </div>
</form>

<script>
function addRow() {
  const table = document.getElementById("coTable").getElementsByTagName("tbody")[0];
  const rowCount = table.rows.length;
  let row = table.insertRow(rowCount);

  row.innerHTML = `
    <td><input type="text" name="co_text_${rowCount}" class="form-control" /></td>
    <td><input type="text" name="details_${rowCount}" class="form-control" /></td>
    <td><input type="text" name="verb_${rowCount}" class="form-control" /></td>
    <td><input type="text" name="level_${rowCount}" class="form-control" /></td>
  `;
  document.getElementById("total_rows").value = rowCount + 1;
}
</script>
{% endblock content %}

<!DOCTYPE html>
<html>

<head>
    <title>Articulation Matrix</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed;
        }

        th,
        td {
            border: 1px solid black;
            text-align: center;
            padding: 4px;
            word-wrap: break-word;
        }

        th {
            background-color: #f2f2f2;
        }

        .avg-row {
            background-color: red;
            color: white;
        }

        input {
            width: 100%;
            box-sizing: border-box;
        }
    </style>
    <script>
        function calculateAverage() {
            var table = document.getElementById("mappingTable");
            var rows = table.rows;
            var totalCols = rows[0].cells.length - 1; // Exclude the first column

            for (var col = 1; col <= totalCols; col++) {
                var sum = 0;
                var count = 0;
                for (var row = 1; row < rows.length - 1; row++) {
                    var cell = rows[row].cells[col].getElementsByTagName("input")[0];
                    var value = parseFloat(cell.value);
                    if (!isNaN(value)) {
                        sum += value;
                        count++;
                    }
                }
                var average = count > 0 ? (sum / count).toFixed(2) : "-";
                rows[rows.length - 1].cells[col].getElementsByTagName("input")[0].value = average;
            }
        }
    </script>
</head>

<body>
    <h2>Articulation Matrix</h2>
    <table id="mappingTable">
        <tr>
            <th style="width: 10px;"> </th>
            <th style="width: 10px;">PO1</th>
            <th style="width: 10px;">PO2</th>
            <th style="width: 10px;">PO3</th>
            <th style="width: 10px;">PO4</th>
            <th style="width: 10px;">PO5</th>
            <th style="width: 10px;">PO6</th>
            <th style="width: 10px;">PO7</th>
            <th style="width: 10px;">PO8</th>
            <th style="width: 10px;">PO9</th>
            <th style="width: 10px;">PO10</th>
            <th style="width: 10px;">PO11</th>
            <th style="width: 10px;">PO12</th>
            <th style="width: 10px;">PSO1</th>
            <th style="width: 10px;">PSO2</th>
        </tr>
        <tr>
            <td>CO1</td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
        </tr>
        <tr>
            <td>CO2</td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
        </tr>
        <tr>
            <td>CO3</td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
        </tr>
        <tr>
            <td>CO4</td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
        </tr>
        <tr>
            <td>CO5</td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
        </tr>
        <tr>
            <td>CO6</td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
            <td><input type="number" oninput="calculateAverage()"></td>
        </tr>
        <tr class="avg-row">
            <td>Average</td>
            <td><input type="text" readonly></td>
            <td><input type="text" readonly></td>
            <td><input type="text" readonly></td>
            <td><input type="text" readonly></td>
            <td><input type="text" readonly></td>
            <td><input type="text" readonly></td>
            <td><input type="text" readonly></td>
            <td><input type="text" readonly></td>
            <td><input type="text" readonly></td>
            <td><input type="text" readonly></td>
            <td><input type="text" readonly></td>
            <td><input type="text" readonly></td>
            <td><input type="text" readonly></td>
            <td><input type="text" readonly></td>
        </tr>
        </tfoot>
    </table>
    </div>
</body>

</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>University Syllabus</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #000;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f4f4f4;
        }
        .form-container {
            margin-bottom: 20px;
        }
        input, textarea, button {
            margin: 5px 0;
            padding: 8px;
            width: 100%;
            box-sizing: border-box;
        }
        button {
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>University Syllabus</h1>

    <div class="form-container">
        <h3>Add Syllabus Entry</h3>
        <label for="unit">Unit:</label>
        <input type="text" id="unit" placeholder="Enter Unit Number">

        <label for="content">Content:</label>
        <textarea id="content" rows="5" placeholder="Enter Content"></textarea>

        <label for="hrs">Hrs/Unit:</label>
        <input type="number" id="hrs" min="1" max="9" placeholder="Enter Hours Per Unit">

        <button onclick="addEntry()">Add to Syllabus</button>
    </div>

    <table id="syllabusTable">
        <thead>
            <tr>
                <th>Unit</th>
                <th>Content</th>
                <th>Hrs/Unit</th>
            </tr>
        </thead>
        <tbody>
            <!-- Existing syllabus entries can be added here -->
        </tbody>
    </table>

    <script>
        function addEntry() {
            // Get values from input fields
            const unit = document.getElementById('unit').value.trim();
            const content = document.getElementById('content').value.trim();
            const hrs = document.getElementById('hrs').value.trim();

            // Validate inputs
            if (!unit || !content || !hrs) {
                alert('Please fill out all fields.');
                return;
            }

            // Add new row to the table
            const table = document.getElementById('syllabusTable').getElementsByTagName('tbody')[0];
            const newRow = table.insertRow();

            const unitCell = newRow.insertCell(0);
            const contentCell = newRow.insertCell(1);
            const hrsCell = newRow.insertCell(2);

            unitCell.textContent = unit;
            contentCell.textContent = content;
            hrsCell.textContent = hrs;

            // Clear input fields
            document.getElementById('unit').value = '';
            document.getElementById('content').value = '';
            document.getElementById('hrs').value = '';
        }
    </script>
</body>
</html>