{% extends "_base.html" %}
{% load static %}
{% block content %}
<h3>Create CO</h3>
<form method="POST">
  {% csrf_token %}
  <label for="batch_selector">Select Batch:</label>
  <select id="batch_selector" name="batch_selector">
    <option value="">-- Select Batch --</option>
    {% for b in batches %}
      <option value="{{ b.id }}">{{ b.name }}</option>
    {% endfor %}
  </select>
  <br>
  <label for="semester_selector">Select Semester:</label>
  <select id="semester_selector" name="semester_selector">
    <option value="">-- Select Semester --</option>
    {% for s in semesters %}
      <option value="{{ s.id }}">{{ s.semester_name }}</option>
    {% endfor %}
  </select>
  <br>
  <label for="course_selector">Select Course:</label>
  <select id="course_selector" name="course_selector">
    <option value="">-- Select Course --</option>
    {% for c in courses %}
      <option value="{{ c.id }}">{{ c.course_title }}</option>
    {% endfor %}
  </select>
  <hr>
  <table id="coTable" class="table">
    <thead>
      <tr>
        <th>CO Text</th>
        <th>Details</th>
        <th>Action Verb</th>
        <th>Knowledge Level</th>
      </tr>
    </thead>
    <tbody>
      <!-- Rows will be added by JS -->
    </tbody>
  </table>
  <input type="hidden" name="total_rows" id="total_rows" value="0" />
  <button type="button" onclick="addRow()">Add Row</button>
  <br><br>
  <button type="submit">Submit</button>
</form>

<script>
function addRow() {
  const table = document.getElementById("coTable").getElementsByTagName("tbody")[0];
  const rowCount = table.rows.length;
  let row = table.insertRow(rowCount);

  row.innerHTML = `
    <td><input type="text" name="co_text_${rowCount}" /></td>
    <td><input type="text" name="details_${rowCount}" /></td>
    <td><input type="text" name="verb_${rowCount}" /></td>
    <td><input type="text" name="level_${rowCount}" /></td>
  `;
  document.getElementById("total_rows").value = rowCount + 1;
}
</script>
{% endblock content %}